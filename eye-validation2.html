<html>
<head>
  <title>Hw 11, problem 1 lab page</title>
</head>

<body>


<!-- The overlay -->
<div id="topLeft" class="overlay">
  <!-- Button to close the overlay navigation -->
  <a href="javascript:void(0)" class="closebtn" onclick="hardCloseNav()">&times;</a>
  <!-- Overlay content -->
  <div class="overlay-content1">
    <img src="reddot.png" height="100" onclick="startTimer()">
  </div>
</div>

<div id="topRight" class="overlay">
  <!-- Button to close the overlay navigation -->
  <a href="javascript:void(0)" class="closebtn" onclick="hardCloseNav()">&times;</a>
  <!-- Overlay content -->
  <div class="overlay-content2">
    <img src="reddot.png" height="100" onclick="startTimer()">
  </div>
</div>

<div id="bottomLeft" class="overlay">
  <!-- Button to close the overlay navigation -->
  <a href="javascript:void(0)" class="closebtn" onclick="hardCloseNav()">&times;</a>
  <!-- Overlay content -->
  <div class="overlay-content3">
    <img src="reddot.png" height="100" onclick="startTimer()">
  </div>
</div>

<div id="bottomRight" class="overlay">
  <!-- Button to close the overlay navigation -->
  <a href="javascript:void(0)" class="closebtn" onclick="hardCloseNav()">&times;</a>
  <!-- Overlay content -->
  <div class="overlay-content4">
    <img src="reddot.png" height="100" onclick="startTimer()">
  </div>
</div>

<!-- Use any element to open/show the overlay navigation menu 
<span onclick="openNav()">open1</span>    -->

  <script src="webgazer.js"></script>
  <script>

var TRUE_X = [0.8,.15,.8,.15];
var TRUE_Y = [0.8,.15,.15,.8];
var VALIDATION_RATE = 10000;
var SIZE_OF_CIRCLE = 100;
var in_circle = 0;
var out_circle = 0;
var dist_list = [];
var x_val_points = [];
var y_val_points = [];
var x_points = [];
var y_points = [];
var time_poits = [];
var collect_validation = false;
var in_validation = false;
var last_validation = 0;

var overlay = 0;
var inuse = 0;
function openNav() {
    switch(overlay){
        case 0:
            document.getElementById("topLeft").style.width = "100%";
            break;
        case 1:
            document.getElementById("topRight").style.width = "100%";
            break;
        case 2:
            document.getElementById("bottomLeft").style.width = "100%";
            break;
        case 3:
            document.getElementById("bottomRight").style.width = "100%";
            break;
    }
}
function closeNav() {
    switch(overlay){
        case 1:
            document.getElementById("topLeft").style.width = "0%";
            break;
        case 2:
            document.getElementById("topRight").style.width = "0%";
            break;
        case 3:
            document.getElementById("bottomLeft").style.width = "0%";
            break;
        case 0:
            document.getElementById("bottomRight").style.width = "0%";
            break;
    }
}
function hardCloseNav() {
    document.getElementById("topLeft").style.width = "0%";
    document.getElementById("topRight").style.width = "0%";
    document.getElementById("bottomLeft").style.width = "0%";
    document.getElementById("bottomRight").style.width = "0%";
    overlay = 0;
    dist_list = [];
    in_validation = false;
}
function startTimer(){
    if(collect_validation==false){
        collect_validation = true;
        //call to collect predictions
        setTimeout(closeNav,3000);
        if(overlay != 3){
            setTimeout(openNav,3000);
        }
        setTimeout(function(){
            collect_validation = false;
            var distances = distance(x_val_points , y_val_points, window.innerWidth * TRUE_X[overlay], window.innerHeight * TRUE_Y[overlay])
            for( index = 0;index < distances.length; index++){
                if(SIZE_OF_CIRCLE > distances[index]){
                    in_circle += 1;
                }
                else{
                    out_circle += 1;
                }
            }
            x_val_points = []; 
            y_val_points = [];
        },3000);
        setTimeout(function(){ },3000);
        overlay += 1;
        overlay = overlay % 4;
    }
}
function distance(x,y,trueX,trueY){
    var dist = [];
    for(i = 0; i<x_val_points.length;i++){
        dist.push(Math.sqrt(Math.pow(x[i]-trueX,2)+Math.pow(y[i]-trueY,2)));
    }
    return dist;
}

//webgazer


    window.onload = function() {
      webgazer.setRegression('ridge') /* currently must set regression and tracker */
      .setTracker('clmtrackr')
      .setGazeListener(function(data, clock) {
         //   console.log(data); /* data is an object containing an x and y key which are the x and y prediction coordinates (no bounds limiting) */
//   console.log(clock); /* elapsed time in milliseconds since webgazer.begin() was called */
         
         if((clock - last_validation) > VALIDATION_RATE ){
             openNav();
             in_validation = true;
         }
         if(in_validation){
             if(collect_validation){
                 if(data != null ){
                     x_val_points.push(data.x);
	             y_val_points.push(data.y);
                 }
             }
	     last_validation = clock
         }
         if(in_validation == false && data != null){
             x_points.push(data.x);
             y_points.push(data.y);
             time_poits.push(clock);
         }
         else{
             x_points.push(null);
             y_points.push(null);
             time_poits.push(clock);
         }
      })
      .begin()
      .showPredictionPoints(true); /* shows a square every 100 milliseconds where current prediction is */

      var width = 320;
      var height = 240;
      var topDist = '0px';
      var leftDist = '0px';
    
      var setup = function() {
        /*var video = document.getElementById('webgazerVideoFeed');
        video.style.display = 'block';
        video.style.position = 'absolute';
        video.style.top = topDist;
        video.style.left = leftDist;
        video.width = width;
        video.height = height;
        video.style.margin = '0px';

        webgazer.params.imgWidth = width;
        webgazer.params.imgHeight = height;*/

        var overlay = document.createElement('canvas');
        overlay.id = 'overlay';
        overlay.style.position = 'absolute';
        overlay.width = width;
        overlay.height = height;
        overlay.style.top = topDist;
        overlay.style.left = leftDist;
        overlay.style.margin = '0px';

        document.body.appendChild(overlay);

        var cl = webgazer.getTracker().clm;

        function drawLoop() {
          requestAnimFrame(drawLoop);
          overlay.getContext('2d').clearRect(0,0,width,height);
          if (cl.getCurrentPosition()) {
            cl.draw(overlay);
          }
        }
        drawLoop();
      };

      function checkIfReady() {
        if (webgazer.isReady()) {
          setup();
        } else {
          setTimeout(checkIfReady, 100);
        }
      }
      setTimeout(checkIfReady,100);
    };

    window.onbeforeunload = function() {
      //webgazer.end(); //Uncomment if you want to save the data even if you reload the page.
      window.localStorage.clear(); //Comment out if you want to save data across different sessions 
    }
  </script>
  
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=277249642292728";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <h3>Hw 11 answers</h3>
  <!-- This is an HTML comment -->

  <h3>Hw 11 answers</h3>
  <!-- This is an HTML comment -->
  <h3>Hw 11 answers</h3>
  <!-- This is an HTML comment -->
  <h3>Hw 11 answers</h3>
  <!-- This is an HTML comment -->
  <h3>Hw 11 answers</h3>
  <!-- This is an HTML comment -->
  <h3>Hw 11 answers</h3>
  <!-- This is an HTML comment -->
  <h3>Hw 11 answers</h3>
  <!-- This is an HTML comment -->

  <h3>Hw 11 answers</h3>
  <!-- This is an HTML comment -->
  <h3>Hw 11 answers</h3>
  <!-- This is an HTML comment -->
  <h3>Hw 11 answers</h3>
  <!-- This is an HTML comment -->
  <h3>Hw 11 answers</h3>
  <!-- This is an HTML comment -->
  <h3>Hw 11 answers</h3>
  <!-- This is an HTML comment -->
  <h3>Hw 11 answers</h3>
  <!-- This is an HTML comment -->

  <h3>Hw 11 answers</h3>
  <!-- This is an HTML comment -->
  <h3>Hw 11 answers</h3>
  <!-- This is an HTML comment -->
  <h3>Hw 11 answers</h3>
  <!-- This is an HTML comment -->
  <h3>Hw 11 answers</h3>
  <!-- This is an HTML comment -->
  <h3>Hw 11 answers</h3>
  <!-- This is an HTML comment -->
  

  <ul>
    <!-- start unordered list -->


    <li><b>Name:</b> John Simmons</li>


    <li style="list-style: none"><br>
    <br>
    <!-- these are line breaks -->
    </li>


    <li><b>Favorite:</b> Photograph of myself is this one: <img src=
    "alienBig.png" height="100"><br>
    <br></li>


    <li><b>Favorite:</b> My favorite canned meat product is spam.<br>
    My favorite <a href=
		"http://www.lewisburgpa.com/">
    town</a> is Lewisburg!</li>


    <li style="list-style: none"><br>
    <br>
    </li>


    <li><b>Least favorite:</b> My least favorite HTML tag is
    <blink>blink</blink><br>
    <marquee direction="left" width="300px">The marquee tag is a close
    second...</marquee></li>

    <li><i>I like:</i> I like to play hockey and read books.</li>
    
    <li><b>Website critique:</b> The web site I chose to critique is linked  
    <a href = "https://www.huntington.com/"> here </a>

    <li style="list-style: none"><br>
    <br>
    </li>
  </ul>
  <!-- end unordered list -->
  Views expressed here are those of the author; Bucknell does not endorse spam
  or marquee text.
<li>
<div class="fb-like" data-href="https://developers.facebook.com/docs/plugins/" data-layout="standard" data-action="like" data-show-faces="true" data-share="true"></div>
</li>

</body>


<style>

/* The Overlay (background) */
.overlay {
    /* Height & width depends on how you want to reveal the overlay (see JS below) */    
    height: 100%;
    width: 0;
    position: fixed; /* Stay in place */
    z-index: 1; /* Sit on top */
    left: 0;
    top: 0;
    background-color: rgb(0,0,0); /* Black fallback color */
    background-color: rgba(0,0,0, 0.9); /* Black w/opacity */
    overflow-x: hidden; /* Disable horizontal scroll */
    transition: 0s; /* 0.5 second transition effect to slide in or slide down the overlay (height or width, depending on reveal) */
}

/* Position the content inside the overlay */
.overlay-content1 {
    position: absolute;
    top: 15%; /* 25% from the top */
    left: 15%;
}
/* Position the content inside the overlay */
.overlay-content2 {
    position: absolute;
    top: 15%; /* 25% from the top */
    left: 80%;
}

/* Position the content inside the overlay */
.overlay-content3 {
    position: absolute;
    top: 80%; /* 25% from the top */
    left: 15%;
}

/* Position the content inside the overlay */
.overlay-content4 {
    position: absolute;
    top: 80%; /* 25% from the top */
    left: 80%;
}

/* The navigation links inside the overlay */
.overlay a {
    padding: 8px;
    text-decoration: none;
    font-size: 36px;
    color: #818181;
    display: block; /* Display block instead of inline */
    transition: 0.3s; /* Transition effects on hover (color) */
}

/* Position the close button (top right corner) */
.overlay .closebtn {
    position: absolute;
    top: 20px;
    right: 45px;
    font-size: 60px;
}

</style>

</html>
